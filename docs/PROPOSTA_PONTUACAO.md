# üéØ PROPOSTA ESTRAT√âGICA - SISTEMA DE VIGOR (PONTUA√á√ÉO)

*Rota Business Club - Revis√£o 23/01/2026*

---

## üìã PRIORIDADES DE NEG√ìCIO (definidas pelo Igor)

| # | Prioridade | Objetivo | Peso |
|---|------------|----------|------|
| **0** | üèÜ Lan√ßar projetos/elos | **GERAR NEG√ìCIOS** (principal) | **M√ÅXIMO** |
| **1** | ü§ù Intera√ß√£o entre membros | Networking ativo | ALTO |
| **2** | üì± Logins di√°rios | Engajamento cont√≠nuo | M√âDIO |
| **3** | üì∏ Gerar conte√∫do | Feed vivo, fotos, posts | M√âDIO |

---

## üß† FILOSOFIA DE PONTUA√á√ÉO

### Princ√≠pios

1. **A√ß√µes que geram neg√≥cios = mais pontos**
2. **A√ß√µes sociais = pontos m√©dios**
3. **A√ß√µes passivas = pontos baixos**
4. **A√ß√µes autom√°ticas = pontos m√≠nimos ou zero**

### Escala Base

```
ALTO     = 50-150 pts (a√ß√µes de neg√≥cio)
M√âDIO    = 20-50 pts  (a√ß√µes sociais)
BAIXO    = 10-20 pts  (a√ß√µes de conte√∫do)
M√çNIMO   = 5-10 pts   (a√ß√µes b√°sicas)
```

---

## üìä PROPOSTA DE PONTUA√á√ÉO REVISADA

### üèÜ CATEGORIA: PROJETOS/NEG√ìCIOS (Prioridade 0)

| A√ß√£o | Pts Atual | Pts Proposto | Justificativa |
|------|-----------|--------------|---------------|
| Lan√ßar projeto (solicitar or√ßamento) | ‚ùå N√£o existe | **100** | Inten√ß√£o direta de neg√≥cio |
| Receber proposta de projeto | ‚ùå N√£o existe | **50** | Demanda ativa |
| Fechar contrato/projeto | ‚ùå N√£o existe | **200** | Neg√≥cio concretizado! |
| Dar avalia√ß√£o ap√≥s projeto | ‚ùå N√£o existe | **30** | Feedback importante |

üìå **Nota:** M√≥dulo de projetos precisa ser conectado ao sistema de pontos.

---

### ü§ù CATEGORIA: ELOS/CONEX√ïES (Prioridade 0)

| A√ß√£o | Pts Atual | Pts Proposto | Mudan√ßa | Justificativa |
|------|-----------|--------------|---------|---------------|
| Enviar solicita√ß√£o de elo | 10 | **20** | +10 | Iniciativa de networking |
| Aceitar elo | 20 | **30** | +10 | Expandir rede |
| **MEDALHA: Presente** (1¬∫ elo) | 50 | **100** | +50 | Marco importante |

---

### üî• CATEGORIA: CONFRARIAS (Prioridade 1)

| A√ß√£o | Pts Atual | Pts Proposto | Mudan√ßa | Justificativa |
|------|-----------|--------------|---------|---------------|
| Criar confraria | 50 | **40** | -10 | Criar √© f√°cil |
| Enviar convite | ‚ùå N√£o existe | **5** | +5 | Esfor√ßo pequeno |
| Aceitar convite | 10 | **15** | +5 | Compromisso |
| Participar (anfitri√£o) | 100 | **80** | -20 | Alto, mas n√£o exagerado |
| Participar (convidado) | 50 | **50** | = | OK |
| Upload foto de confraria | 30 | **25** | -5 | Prova social |
| **MEDALHA: Primeira Confraria** | 100 | **80** | -20 | Marco |
| **MEDALHA: Anfitri√£o** | 150 | **100** | -50 | 1¬™ vez anfitri√£o |
| **MEDALHA: Cronista** | 50 | **50** | = | 1¬™ foto |
| **MEDALHA: Networker Ativo** (2+/m√™s) | 200 | **150** | -50 | Mensal |
| **MEDALHA: L√≠der de Confraria** (5+/m√™s) | 500 | **300** | -200 | Era muito alto |
| **MEDALHA: Mestre Conex√µes** (10+/m√™s) | 1000 | **500** | -500 | Era absurdo |

---

### üì± CATEGORIA: ENGAJAMENTO DI√ÅRIO (Prioridade 2)

| A√ß√£o | Pts Atual | Pts Proposto | Justificativa |
|------|-----------|--------------|---------------|
| Login di√°rio | ‚ùå N√£o existe | **5** | Incentivo pequeno mas constante |
| Streak 7 dias | ‚ùå N√£o implementado | **30** | B√¥nus de consist√™ncia |
| Streak 30 dias | ‚ùå N√£o implementado | **100** | Grande conquista |
| **MEDALHA: Pronto para Miss√£o** (7 dias) | 100 | **50** | Valorizar consist√™ncia |
| **MEDALHA: Inabal√°vel** (30 dias) | 200 | **150** | Fidelidade |

---

### üì∏ CATEGORIA: CONTE√öDO/FEED (Prioridade 3)

| A√ß√£o | Pts Atual | Pts Proposto | Justificativa |
|------|-----------|--------------|---------------|
| Publicar post no feed | ‚ùå N√£o existe | **15** | Gerar conte√∫do |
| Upload foto trabalho | 30 | **20** | Portfolio |
| Receber like no post | ‚ùå N√£o existe | **2** | Micro-recompensa |
| Receber coment√°rio | ‚ùå N√£o existe | **5** | Intera√ß√£o |
| Comentar em post | ‚ùå N√£o existe | **5** | Engajamento |
| **MEDALHA: Cinegrafista de Campo** | 100 | **60** | Primeiro upload |

---

### üë§ CATEGORIA: PERFIL (B√°sico)

| A√ß√£o | Pts Atual | Pts Proposto | Justificativa |
|------|-----------|--------------|---------------|
| **MEDALHA: Alistamento Conclu√≠do** | 100 | **80** | Perfil b√°sico |
| **MEDALHA: Batismo Excel√™ncia** | 200 | **150** | 1¬™ avalia√ß√£o 5‚òÖ |

---

## üìà COMPARATIVO TOTAL

### Antes vs Depois

| Categoria | Antes | Depois | Mudan√ßa |
|-----------|-------|--------|---------|
| Projetos/Neg√≥cios | 0 pts | ~380 pts | +380 |
| Elos | ~80 pts | ~150 pts | +70 |
| Confrarias | ~2.060 pts | ~1.345 pts | -715 |
| Engajamento | ~300 pts | ~335 pts | +35 |
| Conte√∫do | ~130 pts | ~107 pts | -23 |
| Perfil | ~300 pts | ~230 pts | -70 |

### Resultado:
- ‚úÖ **Neg√≥cios priorizados** (de 0 para 380+ pts)
- ‚úÖ **Confrarias mais equilibradas** (menos infla√ß√£o)
- ‚úÖ **Engajamento di√°rio incentivado** (novo m√≥dulo)
- ‚úÖ **Feed valorizado** (a√ß√µes de conte√∫do)

---

## üèóÔ∏è IMPLEMENTA√á√ÉO T√âCNICA

### Fase 1: Criar tabela `point_actions`

```sql
CREATE TABLE point_actions (
    id TEXT PRIMARY KEY,
    name TEXT NOT NULL,
    description TEXT,
    points_base INTEGER NOT NULL DEFAULT 0,
    category TEXT NOT NULL,
    is_active BOOLEAN DEFAULT true,
    is_monthly BOOLEAN DEFAULT false, -- Se reseta mensalmente
    max_per_day INTEGER DEFAULT NULL, -- Limite di√°rio (null = ilimitado)
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- √çndices
CREATE INDEX idx_point_actions_category ON point_actions(category);
CREATE INDEX idx_point_actions_active ON point_actions(is_active);
```

### Fase 2: Popular tabela com a√ß√µes

```sql
INSERT INTO point_actions (id, name, points_base, category, is_monthly, max_per_day, description) VALUES
-- Elos
('elo_sent', 'Enviar solicita√ß√£o de elo', 20, 'connections', false, 10, 'Enviar convite de conex√£o'),
('elo_accepted', 'Aceitar elo', 30, 'connections', false, 10, 'Aceitar solicita√ß√£o de conex√£o'),

-- Confrarias
('confraternity_created', 'Criar confraria', 40, 'confraternity', false, 3, 'Criar nova confraria'),
('confraternity_invite_sent', 'Enviar convite', 5, 'confraternity', false, 20, 'Convidar para confraria'),
('confraternity_accepted', 'Aceitar convite', 15, 'confraternity', false, 5, 'Aceitar convite de confraria'),
('confraternity_host', 'Participar (anfitri√£o)', 80, 'confraternity', false, 3, 'Ser anfitri√£o'),
('confraternity_guest', 'Participar (convidado)', 50, 'confraternity', false, 5, 'Participar como convidado'),
('confraternity_photo', 'Upload foto', 25, 'confraternity', false, 5, 'Enviar foto de confraria'),

-- Engajamento
('daily_login', 'Login di√°rio', 5, 'engagement', false, 1, 'Primeiro login do dia'),
('streak_7_days', 'Streak 7 dias', 30, 'engagement', false, NULL, 'B√¥nus por 7 dias seguidos'),
('streak_30_days', 'Streak 30 dias', 100, 'engagement', false, NULL, 'B√¥nus por 30 dias seguidos'),

-- Conte√∫do
('feed_post', 'Publicar post', 15, 'content', false, 5, 'Post no feed Na Rota'),
('portfolio_upload', 'Upload portfolio', 20, 'content', false, 5, 'Foto de trabalho'),
('post_like_received', 'Receber like', 2, 'content', false, 50, 'Algu√©m curtiu seu post'),
('post_comment_received', 'Receber coment√°rio', 5, 'content', false, 20, 'Coment√°rio no seu post'),
('post_comment_sent', 'Comentar', 5, 'content', false, 10, 'Comentar em post'),

-- Projetos
('project_requested', 'Lan√ßar projeto', 100, 'business', false, 3, 'Solicitar or√ßamento'),
('project_proposal_received', 'Receber proposta', 50, 'business', false, 10, 'Proposta recebida'),
('project_closed', 'Fechar contrato', 200, 'business', false, NULL, 'Neg√≥cio fechado!'),
('project_review_given', 'Avaliar projeto', 30, 'business', false, NULL, 'Dar avalia√ß√£o');
```

### Fase 3: Atualizar tabela `medals`

```sql
UPDATE medals SET points_reward = 80 WHERE id = 'alistamento_concluido';
UPDATE medals SET points_reward = 150 WHERE id = 'batismo_excelencia';
UPDATE medals SET points_reward = 100 WHERE id = 'presente';
UPDATE medals SET points_reward = 80 WHERE id = 'primeira_confraria';
UPDATE medals SET points_reward = 100 WHERE id = 'anfitriao';
UPDATE medals SET points_reward = 50 WHERE id = 'cronista';
UPDATE medals SET points_reward = 150 WHERE id = 'networker_ativo';
UPDATE medals SET points_reward = 300 WHERE id = 'lider_confraria';
UPDATE medals SET points_reward = 500 WHERE id = 'mestre_conexoes';
UPDATE medals SET points_reward = 60 WHERE id = 'cinegrafista_campo';
UPDATE medals SET points_reward = 50 WHERE id = 'pronto_para_missao';
UPDATE medals SET points_reward = 150 WHERE id = 'inabalavel';
```

### Fase 4: Criar fun√ß√£o `awardPointsForAction`

```typescript
export async function awardPointsForAction(
    userId: string,
    actionId: string,
    description?: string,
    metadata?: Record<string, any>
): Promise<{ success: boolean; points: number; error?: string }> {
    const supabase = createClient()
    
    // Buscar a√ß√£o do banco
    const { data: action } = await supabase
        .from('point_actions')
        .select('*')
        .eq('id', actionId)
        .eq('is_active', true)
        .single()
    
    if (!action) {
        return { success: false, points: 0, error: 'A√ß√£o n√£o encontrada ou inativa' }
    }
    
    // Verificar limite di√°rio
    if (action.max_per_day) {
        const today = new Date().toISOString().split('T')[0]
        const { count } = await supabase
            .from('points_history')
            .select('*', { count: 'exact', head: true })
            .eq('user_id', userId)
            .eq('action_type', actionId)
            .gte('created_at', `${today}T00:00:00`)
        
        if (count && count >= action.max_per_day) {
            return { success: false, points: 0, error: 'Limite di√°rio atingido' }
        }
    }
    
    // Chamar awardPoints com os pontos din√¢micos
    return await awardPoints(
        userId,
        action.points_base,
        actionId,
        description || action.description,
        metadata
    )
}
```

### Fase 5: Adicionar aba no Admin

Criar UI em `/admin/game` para gerenciar `point_actions`.

---

## ‚úÖ CHECKLIST DE IMPLEMENTA√á√ÉO

- [ ] 1. Criar tabela `point_actions`
- [ ] 2. Popular com a√ß√µes existentes
- [ ] 3. Atualizar valores das medalhas
- [ ] 4. Criar fun√ß√£o `awardPointsForAction`
- [ ] 5. Refatorar todos os `awardPoints` hardcoded
- [ ] 6. Adicionar aba "A√ß√µes" no admin
- [ ] 7. Testar multiplicadores
- [ ] 8. Deploy e validar

---

## ü§î DECIS√ïES PENDENTES

1. **Limite di√°rio de pontos?** (evitar farming)
2. **Sistema de streak precisa de CRON?**
3. **Projetos existem ou precisam ser criados?**
4. **Feed "Na Rota" tem sistema de posts?**

---

*Documento gerado por: Time de Arquitetura*
*Rafael (DBA) + Carlos (Backend) + Lucas (UX)*
